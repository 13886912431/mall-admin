(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a121267"],{"0cd7":function(t,e,a){},"79e1":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-list"},[a("SearchArea",{attrs:{categoryList:t.categoryList},on:{submit:t.submit}}),a("ProductTable",{attrs:{data:t.productList,page:t.page},on:{changePage:t.changePage,delete:t.handleDelete}})],1)},n=[],c=(a("4160"),a("d81d"),a("b0c0"),a("159b"),a("5530")),o=(a("96cf"),a("1da1")),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-table"},[a("a-table",{attrs:{columns:t.columns,"data-source":t.tableData,pagination:t.page},on:{change:function(e){return t.$emit("changePage",e)}},scopedSlots:t._u([{key:"operate",fn:function(e){return a("div",{staticClass:"operate"},[a("a-button",{attrs:{type:"primary"},on:{click:function(a){return t.handleEdit(e)}}},[t._v("编辑")]),a("a-button",{attrs:{type:"danger"},on:{click:function(a){return t.handleDelete(e)}}},[t._v("删除")])],1)}},{key:"images",fn:function(t){return a("div",{staticClass:"images"},[a("img",{attrs:{src:t[0],width:"90",height:"90"}})])}}])})],1)},s=[],u=a("c4c8"),d={name:"ProductTable",props:["data","page"],data:function(){return{columns:[{title:"id",dataIndex:"id"},{title:"图片",dataIndex:"images",scopedSlots:{customRender:"images"}},{title:"标题",dataIndex:"title"},{title:"描述",dataIndex:"desc"},{title:"类目",dataIndex:"categoryName"},{title:"预售价格",dataIndex:"price"},{title:"折扣价格",dataIndex:"price_off"},{title:"标签",dataIndex:"tags"},{title:"限制购买数量",dataIndex:"inventory"},{title:"上架状态",dataIndex:"status",customRender:function(t){return 1===t?"上架":"下架"}},{title:"操作",key:"operate",scopedSlots:{customRender:"operate"}}]}},computed:{tableData:function(){return this.data.map((function(t){return Object(c["a"])(Object(c["a"])({},t),{},{key:t.id})}))}},methods:{handleEdit:function(t){console.log(t),sessionStorage.setItem("editForm",JSON.stringify(t)),this.$router.push({name:"ProductAdd",query:{editid:t.id}})},handleDelete:function(t){var e=this;this.$createElement;this.$modal.confirm({title:function(e){return e("div",["确定删除 ",e("span",{style:"color: #1890ff;"},[t.title])," 吗？"])},mask:!0,maskClosable:!0,cancelText:"取消",okText:"确定",onOk:function(){var a=Object(o["a"])(regeneratorRuntime.mark((function a(r){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,u["a"].delete(t.id);case 2:r(),e.$message.success("删除成功"),e.$emit("delete");case 5:case"end":return a.stop()}}),a)})));function r(t){return a.apply(this,arguments)}return r}()})}}},l=d,p=(a("a12a"),a("2877")),m=Object(p["a"])(l,i,s,!1,null,"6c2b1c3e",null),f=m.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"search-area"},[a("a-form-model",{attrs:{layout:"inline",model:t.form}},[a("div",[a("a-form-model-item",{attrs:{label:"搜索关键字"}},[a("a-input",{attrs:{placeholder:"输入关键字"},model:{value:t.form.searchWord,callback:function(e){t.$set(t.form,"searchWord","string"===typeof e?e.trim():e)},expression:"form.searchWord"}})],1),a("a-form-model-item",{attrs:{label:"商品类名"}},[a("a-select",{staticStyle:{width:"194px"},attrs:{allowClear:"",placeholder:"选择商品类名"},model:{value:t.form.category,callback:function(e){t.$set(t.form,"category",e)},expression:"form.category"}},t._l(t.categoryList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.name)+" ")])})),1)],1),a("a-form-model-item",[a("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.$emit("submit",t.form)}}},[t._v(" 搜索 ")])],1)],1),a("a-form-model-item",{staticClass:"add-product"},[a("a-button",{on:{click:function(e){return t.$router.push({name:"ProductAdd"})}}},[t._v(" 添加商品 ")])],1)],1)],1)},h=[],b={name:"SearchArea",data:function(){return{form:{searchWord:"",category:""}}},props:["categoryList"]},y=b,v=(a("e679a"),Object(p["a"])(y,g,h,!1,null,"bda88328",null)),x=v.exports,k=a("c405"),w={name:"ProductList",components:{SearchArea:x,ProductTable:f},data:function(){return{page:{current:1,pageSize:10,total:1,showSizeChanger:!0},searchForm:{},productList:[],categoryList:[],categoryMap:{}}},methods:{submit:function(t){this.searchForm=t,this.getProductList()},getProductList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=Object(c["a"])({page:t.page.current,size:t.page.pageSize},t.searchForm),e.next=3,u["a"].productList({params:a});case 3:r=e.sent,console.log(r),t.productList=r.data.map((function(e){return Object(c["a"])(Object(c["a"])({},e),{},{categoryName:t.categoryMap[e.category]})})),t.page.total=r.total;case 7:case"end":return e.stop()}}),e)})))()},getCategoryList:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,k["a"].categoryList();case 2:a=e.sent,t.categoryList=a.data,t.categoryList.forEach((function(e){t.categoryMap[e.id]=e.name}));case 5:case"end":return e.stop()}}),e)})))()},changePage:function(t){this.page.current=t.current,this.page.pageSize=t.pageSize,this.getProductList()},handleDelete:function(){this.getProductList()}},created:function(){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCategoryList();case 2:t.getProductList();case 3:case"end":return e.stop()}}),e)})))()}},L=w,P=Object(p["a"])(L,r,n,!1,null,null,null);e["default"]=P.exports},a12a:function(t,e,a){"use strict";a("0cd7")},c405:function(t,e,a){"use strict";var r=a("bb36");e["a"]={categoryList:function(t){return r["a"].get("/category/all",t)}}},c4c8:function(t,e,a){"use strict";var r=a("bb36");e["a"]={productList:function(t){return r["a"].get("/products/all",t)},delete:function(t){return r["a"].delete("/products/".concat(t))},add:function(t){return r["a"].post("/products/add",t)},edit:function(t){return r["a"].put("/products/edit",t)}}},cb5b:function(t,e,a){},d81d:function(t,e,a){"use strict";var r=a("23e7"),n=a("b727").map,c=a("1dde"),o=a("ae40"),i=c("map"),s=o("map");r({target:"Array",proto:!0,forced:!i||!s},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},e679a:function(t,e,a){"use strict";a("cb5b")}}]);