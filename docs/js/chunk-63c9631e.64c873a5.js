(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63c9631e"],{"9de2":function(e,r,t){},a55b:function(e,r,t){"use strict";t.r(r);var n=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"login"},[t("a-form-model",{ref:"loginForm",attrs:{model:e.form,"label-col":{span:6},"wrapper-col":{span:14},rules:e.rules},nativeOn:{keydown:function(r){return!r.type.indexOf("key")&&e._k(r.keyCode,"enter",13,r.key,"Enter")?null:e.login("loginForm")}}},[t("a-form-model-item",{attrs:{label:"邮箱",prop:"email",required:""}},[t("a-input",{model:{value:e.form.email,callback:function(r){e.$set(e.form,"email","string"===typeof r?r.trim():r)},expression:"form.email"}})],1),t("a-form-model-item",{attrs:{label:"密码",prop:"password",required:""}},[t("a-input",{attrs:{type:"password"},model:{value:e.form.password,callback:function(r){e.$set(e.form,"password","string"===typeof r?r.trim():r)},expression:"form.password"}})],1),e.isRegister?[t("a-form-model-item",{attrs:{label:"验证码",prop:"code",required:""}},[t("a-input-search",{attrs:{"enter-button":"发送验证码"},on:{search:e.sendCode},model:{value:e.form.code,callback:function(r){e.$set(e.form,"code","string"===typeof r?r.trim():r)},expression:"form.code"}})],1),t("a-form-model-item",{attrs:{label:"用户名",prop:"username",required:""}},[t("a-input",{model:{value:e.form.username,callback:function(r){e.$set(e.form,"username","string"===typeof r?r.trim():r)},expression:"form.username"}})],1)]:e._e(),t("a-form-model-item",{attrs:{"wrapper-col":{span:14,offset:6}}},[t("a-button",{attrs:{type:"primary"},on:{click:function(r){return e.login("loginForm")}}},[e._v(" 登录 ")]),t("a-button",{on:{click:function(r){return e.register("loginForm")}}},[e._v(" 注册 ")])],1)],2)],1)},o=[],a=(t("96cf"),t("1da1")),s=t("5530"),i=t("bb36"),u={login:function(e){return i["a"].post("/passport/login",e)},logon:function(e){return i["a"].post("/passport/logon",e)},getCode:function(e){return i["a"].post("/passport/getCode",e)}},c=/^[a-zA-Z0-9_-]+@[a-zA-Z0-9_-]+(\.[a-zA-Z0-9_-]+)+$/,l=function(e,r,t){return r?c.test(r)?t():t(new Error("邮箱格式不正确")):t(new Error("请输入邮箱"))},m=function(e,r,t){return r?t():t(new Error("请输入密码"))},p=function(e,r,t){return r?t():t(new Error("请输入验证码"))},f=function(e,r,t){return r?t():t(new Error("请输入用户名"))},d={email:[{validator:l,trigger:"change"}],password:[{validator:m,trigger:"change"}]},g={code:[{validator:p,trigger:"change"}],username:[{validator:f,trigger:"change"}]},b={name:"Login",data:function(){return{form:{email:"",password:"",code:"",username:""},isRegister:!1}},computed:{rules:function(){return this.isRegister?Object(s["a"])(Object(s["a"])({},d),g):d}},methods:{login:function(e){var r=this;this.isRegister?this.isRegister=!1:this.$refs[e].validate(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return e.prev=1,e.next=4,u.login(r.form);case 4:n=e.sent,r.$store.dispatch("user/login",n),r.$router.push("/"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.$message.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(r){return e.apply(this,arguments)}}())},register:function(e){var r=this;this.isRegister?this.$refs[e].validate(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=12;break}return e.prev=1,e.next=4,u.logon(r.form);case 4:r.isRegister=!1,r.$message.success("注册成功"),r.login("loginForm"),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),r.$message.error(e.t0);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(r){return e.apply(this,arguments)}}()):this.isRegister=!0},sendCode:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function r(){var t;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.form.email){r.next=2;break}return r.abrupt("return",e.$message.info("请先输入您邮箱"));case 2:return e.$message.success("验证码以发送至您的邮箱"),r.next=5,u.getCode({email:e.form.email});case 5:return t=r.sent,r.abrupt("return",t);case 7:case"end":return r.stop()}}),r)})))()}}},h=b,v=(t("b54c"),t("2877")),w=Object(v["a"])(h,n,o,!1,null,"7de545d2",null);r["default"]=w.exports},b54c:function(e,r,t){"use strict";t("9de2")}}]);